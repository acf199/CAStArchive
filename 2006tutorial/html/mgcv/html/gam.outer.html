<html><head><title>R: Minimize GCV or UBRE score of a GAM using 'outer' iteration</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for gam.outer {mgcv}"><tr><td>gam.outer {mgcv}</td><td align="right">R Documentation</td></tr></table>
<h2>Minimize GCV or UBRE score of a GAM using 'outer' iteration</h2>


<h3>Description</h3>

<p>
Estimation of GAM smoothing parameters is most stable if
optimization of the UBRE or GCV score is outer to the penalized iteratively
re-weighted least squares scheme used to estimate the model given smoothing 
parameters.
</p>
<p>
This routine optimizes a GCV or UBRE score in this way. Basically the GCV or
UBRE score is evaluated for each trial set of smoothing parameters by
estimating the GAM for those smoothing parameters. The score is minimized
w.r.t. the parameters numerically, using <code>optim</code> or <code>nlm</code>. Exact
derivatives of the score can be used by fitting with <code><a href="gam.fit2.html">gam.fit2</a></code>,
which improves efficiency and reliability relative to relying solely on finite
difference derivatives.  
</p>
<p>
Not normally called directly, but rather a service routine for <code><a href="gam.html">gam</a></code>.
</p>


<h3>Usage</h3>

<pre>
gam.outer(lsp,fscale,family,control,method,gamma,G)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lsp</code></td>
<td>
The log smoothing parameters.</td></tr>
<tr valign="top"><td><code>fscale</code></td>
<td>
Typical scale of the GCV or UBRE score.</td></tr>
<tr valign="top"><td><code>family</code></td>
<td>
the model family.</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
control argument to pass to <code><a href="gam.fit.html">gam.fit</a></code> if pure
finite differencing is being used.</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
method list reurned from <code><a href="gam.method.html">gam.method</a></code>. This defines
the optimization method to use.</td></tr>
<tr valign="top"><td><code>gamma</code></td>
<td>
The degree of freedom inflation factor for the GCV/UBRE score.</td></tr>
<tr valign="top"><td><code>G</code></td>
<td>
List produced by <code><a href="gam.setup.html">gam.setup</a></code>, containing most of what's
needed to actually fit GAM.</td></tr>
</table>

<h3>Details</h3>

<p>
Estimation of smoothing parameters by optimizing GCV scores obtained at
convergence of the P-IRLS iteration was proposed by O'Sullivan et al. (1986),
and is here termed `outer' iteration.
</p>


<h3>Author(s)</h3>

<p>
Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a>
</p>


<h3>References</h3>

<p>
O 'Sullivan, Yandall &amp; Raynor (1986) Automatic smoothing of regression
functions in generalized linear models. J. Amer. Statist. Assoc. 81:96-103.
</p>
<p>
<a href="http://www.stats.gla.ac.uk/~simon/">http://www.stats.gla.ac.uk/~simon/</a>
</p>


<h3>See Also</h3>

<p>
<code><a href="gam.fit2.html">gam.fit2</a></code>,  <code><a href="gam.html">gam</a></code>, <code><a href="mgcv.html">mgcv</a></code>, <code><a href="magic.html">magic</a></code>
</p>



<hr><div align="center">[Package <em>mgcv</em> version 1.2-3 <a href="00Index.html">Index]</a></div>

</body></html>
