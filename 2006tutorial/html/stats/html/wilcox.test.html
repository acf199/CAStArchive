<html><head><title>R: Wilcoxon Rank Sum and Signed Rank Tests</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for wilcox.test {stats}"><tr><td>wilcox.test {stats}</td><td align="right">R Documentation</td></tr></table>
<h2>Wilcoxon Rank Sum and Signed Rank Tests</h2>


<h3>Description</h3>

<p>
Performs one and two sample Wilcoxon tests on vectors of data; the
latter is also known as &lsquo;Mann-Whitney&rsquo; test.
</p>


<h3>Usage</h3>

<pre>
wilcox.test(x, ...)

## Default S3 method:
wilcox.test(x, y = NULL,
            alternative = c("two.sided", "less", "greater"),
            mu = 0, paired = FALSE, exact = NULL, correct = TRUE,
            conf.int = FALSE, conf.level = 0.95, ...)

## S3 method for class 'formula':
wilcox.test(formula, data, subset, na.action, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
numeric vector of data values.</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
an optional numeric vector of data values.</td></tr>
<tr valign="top"><td><code>alternative</code></td>
<td>
a character string specifying the alternative
hypothesis, must be one of <code>"two.sided"</code> (default),
<code>"greater"</code> or <code>"less"</code>.  You can specify just the initial
letter.</td></tr>
<tr valign="top"><td><code>mu</code></td>
<td>
a number specifying an optional location parameter.</td></tr>
<tr valign="top"><td><code>paired</code></td>
<td>
a logical indicating whether you want a paired test.</td></tr>
<tr valign="top"><td><code>exact</code></td>
<td>
a logical indicating whether an exact p-value should be
computed.</td></tr>
<tr valign="top"><td><code>correct</code></td>
<td>
a logical indicating whether to apply continuity
correction in the normal approximation for the p-value.</td></tr>
<tr valign="top"><td><code>conf.int</code></td>
<td>
a logical indicating whether a confidence interval
should be computed.</td></tr>
<tr valign="top"><td><code>conf.level</code></td>
<td>
confidence level of the interval.</td></tr>
<tr valign="top"><td><code>formula</code></td>
<td>
a formula of the form <code>lhs ~ rhs</code> where <code>lhs</code>
is a numeric variable giving the data values and <code>rhs</code> a factor
with two levels giving the corresponding groups.</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
an optional data frame containing the variables in the
model formula.</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>
an optional vector specifying a subset of observations
to be used.</td></tr>
<tr valign="top"><td><code>na.action</code></td>
<td>
a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to
<code>getOption("na.action")</code>.</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
further arguments to be passed to or from methods.</td></tr>
</table>

<h3>Details</h3>

<p>
The formula interface is only applicable for the 2-sample tests.
</p>
<p>
If only <code>x</code> is given, or if both <code>x</code> and <code>y</code> are given
and <code>paired</code> is <code>TRUE</code>, a Wilcoxon signed rank test of the
null that the distribution of <code>x</code> (in the one sample case) or of
<code>x-y</code> (in the paired two sample case) is symmetric about
<code>mu</code> is performed.
</p>
<p>
Otherwise, if both <code>x</code> and <code>y</code> are given and <code>paired</code>
is <code>FALSE</code>, a Wilcoxon rank sum test (equivalent to the
Mann-Whitney test) is carried out.  In this case, the null hypothesis
is that the location of the distributions of <code>x</code> and <code>y</code>
differ by <code>mu</code>.
</p>
<p>
By default (if <code>exact</code> is not specified), an exact p-value is
computed if the samples contain less than 50 finite values and there
are no ties.  Otherwise, a normal approximation is used.
</p>
<p>
Optionally (if argument <code>conf.int</code> is true), a nonparametric
confidence interval and an estimator for the pseudomedian (one-sample
case) or for the difference of the location parameters <code>x-y</code> is
computed.  (The pseudomedian of a distribution <i>F</i> is the median
of the distribution of <i>(u+v)/2</i>, where <i>u</i> and <i>v</i> are
independent, each with distribution <i>F</i>.  If <i>F</i> is symmetric,
then the pseudomedian and median coincide.  See Hollander &amp; Wolfe
(1973), page 34.)  If exact p-values are available, an exact
confidence interval is obtained by the algorithm described in Bauer
(1972), and the Hodges-Lehmann estimator is employed.  Otherwise, the
returned confidence interval and point estimate are based on normal
approximations.
</p>


<h3>Value</h3>

<p>
A list with class <code>"htest"</code> containing the following components:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>statistic</code></td>
<td>
the value of the test statistic with a name
describing it.</td></tr>
<tr valign="top"><td><code>parameter</code></td>
<td>
the parameter(s) for the exact distribution of the
test statistic.</td></tr>
<tr valign="top"><td><code>p.value</code></td>
<td>
the p-value for the test.</td></tr>
<tr valign="top"><td><code>null.value</code></td>
<td>
the location parameter <code>mu</code>.</td></tr>
<tr valign="top"><td><code>alternative</code></td>
<td>
a character string describing the alternative
hypothesis.</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
the type of test applied.</td></tr>
<tr valign="top"><td><code>data.name</code></td>
<td>
a character string giving the names of the data.</td></tr>
<tr valign="top"><td><code>conf.int</code></td>
<td>
a confidence interval for the location parameter.
(Only present if argument <code>conf.int = TRUE</code>.)</td></tr>
<tr valign="top"><td><code>estimate</code></td>
<td>
an estimate of the location parameter.
(Only present if argument <code>conf.int = TRUE</code>.)</td></tr>
</table>

<h3>References</h3>

<p>
Myles Hollander &amp; Douglas A. Wolfe (1973),
<EM>Nonparametric statistical inference</EM>.
New York: John Wiley &amp; Sons.
Pages 27&ndash;33 (one-sample), 68&ndash;75 (two-sample).
</p>
<p>
David F. Bauer (1972),
Constructing confidence sets using rank statistics.
<EM>Journal of the American Statistical Association</EM>
<B>67</B>, 687&ndash;690.
</p>


<h3>See Also</h3>

<p>
<code><a href="kruskal.test.html">kruskal.test</a></code> for testing homogeneity in location
parameters in the case of two or more samples;
<code><a href="t.test.html">t.test</a></code> for a parametric alternative under normality
assumptions.
</p>


<h3>Examples</h3>

<pre>
## One-sample test.
## Hollander &amp; Wolfe (1973), 29f.
## Hamilton depression scale factor measurements in 9 patients with
##  mixed anxiety and depression, taken at the first (x) and second
##  (y) visit after initiation of a therapy (administration of a
##  tranquilizer).
x &lt;- c(1.83,  0.50,  1.62,  2.48, 1.68, 1.88, 1.55, 3.06, 1.30)
y &lt;- c(0.878, 0.647, 0.598, 2.05, 1.06, 1.29, 1.06, 3.14, 1.29)
wilcox.test(x, y, paired = TRUE, alternative = "greater")
wilcox.test(y - x, alternative = "less")    # The same.
wilcox.test(y - x, alternative = "less",
            exact = FALSE, correct = FALSE) # H&amp;W large sample
                                            # approximation

## Two-sample test.
## Hollander &amp; Wolfe (1973), 69f.
## Permeability constants of the human chorioamnion (a placental
##  membrane) at term (x) and between 12 to 26 weeks gestational
##  age (y).  The alternative of interest is greater permeability
##  of the human chorioamnion for the term pregnancy.
x &lt;- c(0.80, 0.83, 1.89, 1.04, 1.45, 1.38, 1.91, 1.64, 0.73, 1.46)
y &lt;- c(1.15, 0.88, 0.90, 0.74, 1.21)
wilcox.test(x, y, alternative = "g")        # greater
wilcox.test(x, y, alternative = "greater",
            exact = FALSE, correct = FALSE) # H&amp;W large sample
                                            # approximation

wilcox.test(rnorm(10), rnorm(10, 2), conf.int = TRUE)

## Formula interface.
boxplot(Ozone ~ Month, data = airquality)
wilcox.test(Ozone ~ Month, data = airquality,
            subset = Month %in% c(5, 8))
</pre>



<hr><div align="center">[Package <em>stats</em> version 2.1.0 <a href="00Index.html">Index]</a></div>

</body></html>
